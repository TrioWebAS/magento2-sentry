<!-- 8902d55d-316c-4974-9b7b-b6b17f8b0a3c 87cac7c0-26d2-4dbe-9872-ba5d43be573f -->
# Sentry Module Update: Documentation Plan

We will produce four markdown documents under `docs/` to capture: upstream changes, our 2024 merges, a branch diff, and a safe update plan. We will not modify code or history.

## Deliverables (files to create)

- `docs/research/upstream-changes-since-2024-11-15.md`
- `docs/research/our-2024-premature-merges.md`
- `docs/research/diff-upstream-master_vs_origin-production.md`
- `docs/plans/update-path-to-production.md`

## Assumptions and sources

- Last upstream sync date: 2024-11-15 (post `#151` and related changes upstream)
- Upstream repo: `justbetter/magento2-sentry`
- Our repo branch history reference: `origin/production` and `origin/develop`
- Sources to cite:
- Upstream repository: [`https://github.com/justbetter/magento2-sentry`](https://github.com/justbetter/magento2-sentry)
- Our production commits: [`https://github.com/TrioWebAS/magento2-sentry/commits/production/`](https://github.com/TrioWebAS/magento2-sentry/commits/production/)

## Methodology

### 1) Upstream changes since 2024‑11‑15 → `upstream-changes-since-2024-11-15.md`

- Identify the commit on upstream/master closest to 2024‑11‑15 (e.g., around `#151` and subsequent maintenance commits).
- Extract a reverse-chronological list of upstream commits from that point to current `upstream/master`.
- Summarize each change with: date, short title, author, scope (feature/fix/infra), link to commit/PR, and brief impact on Magento usage.
- Group related commits (e.g., performance tracing series, CSP updates, user context enhancements) into thematic sections.
- Include a short “Breaking/Behavioral changes” table and a “Migration notes” section if applicable.

### 2) Our prematurely merged 2024 PRs → `our-2024-premature-merges.md`

- From `origin/develop` and `origin/production` histories, extract merges after 2024‑11‑15 that reference upstream PRs or external forks.
- Build a canonical list with: source PR (URL/ID), merge SHA, summary, files touched, and rationale.
- Note any local-only tweaks not from upstream PRs (e.g., rebrands, env/config conventions) and categorize them as “local customizations”.
- For each item, assess whether upstream/master has equivalent/alternative changes, and note discrepancies.

### 3) Structured diff between branches → `diff-upstream-master_vs_origin-production.md`

- Compare `upstream/master` vs `origin/production` by path category (etc/, Helper/, Plugin/, composer.json, workflows, etc.).
- Summarize diffs at three levels:

1. File presence: added/removed/renamed.
2. High-level code changes: features/config flags, DI rewrites, observers/plugins.
3. Behavior/config impact: defaults, backward compatibility, deprecations.

- Provide concise code excerpt references where crucial to explain behavioral differences.
- Include a “Conflicts to watch” section listing hotspots likely to require manual reconciliation.

### 4) Safe update plan → `update-path-to-production.md`

- Outline a step-by-step, reversible approach to move `origin/production` toward `upstream/master` while preserving required local behavior.
- Define a phased strategy:
- Phase 1: Documentation and alignment (no code changes; verify diffs, define acceptance criteria).
- Phase 2: Create `upgrade/` branches per thematic area (CSP, performance, configuration, vendor rename), merge upstream segments incrementally, feature-flag where needed.
- Phase 3: QA in staging via `develop`, UAT sign-off, then release to `production` with a clear rollback plan.
- Include checklists for: config parity, env compatibility, error/transaction logging sanity, and CSP baseline tests.
- Add a risk register with mitigations and a validation test matrix.

## Editing guidance

- Keep all documents concise, skimmable, and link-rich.
- Use consistent headings: Context, Method, Findings, Impact, Links.
- Prefer bullet lists and small tables over prose.
- Always cite upstream and our fork commit/PR links where relevant.

## Validation

- Cross-check each upstream commit/PR cited with the upstream repo.
- Verify each “our 2024 merge” entry against `origin/develop` and `origin/production` commit logs.
- Have a reviewer confirm the diff summaries against a local git diff.

## References

- Upstream: [`https://github.com/justbetter/magento2-sentry`](https://github.com/justbetter/magento2-sentry)
- Our production history: [`https://github.com/TrioWebAS/magento2-sentry/commits/production/`](https://github.com/TrioWebAS/magento2-sentry/commits/production/)
- Local reference (do not modify): `docs/plans/upstream-status-report.md`

### To-dos

- [ ] Draft docs/research/upstream-changes-since-2024-11-15.md with linked commit summaries
- [ ] Draft docs/research/our-2024-premature-merges.md from production/develop histories
- [ ] Draft docs/research/diff-upstream-master_vs_origin-production.md with path-based analysis
- [ ] Draft docs/plans/update-path-to-production.md with phased rollout and risks
- [ ] Validate all links, commit SHAs, and cross-references in all docs